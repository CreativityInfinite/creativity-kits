/**
 * Sync missing i18n fields (especially tools.*.tags) from zh-CN to en / zh-TW.
 * - Preserves existing fields in en / zh-TW
 * - Only fills missing `tags` arrays using zh-CN as the source of truth
 * - Emits a concise report
 *
 * Usage:
 *   cd creativity-kits
 *   node scripts/correct-tags-i18n.js
 */
const fs = require('fs');
const path = require('path');

const localesDir = path.resolve(__dirname, '../i18n/locales');
const SRC = 'zh-CN.json';
const EN = 'en.json';
const ZH_TW = 'zh-TW.json';

function readJSON(p) {
  return JSON.parse(fs.readFileSync(p, 'utf8'));
}

function writeJSON(p, obj) {
  const content = JSON.stringify(obj, null, 2) + '\n';
  fs.writeFileSync(p, content, 'utf8');
}

function ensureArray(val) {
  return Array.isArray(val) ? val : [];
}

/** Translate zh-CN tags to English using a dictionary; fallback to original */
function translateTagsToEnglish(tags) {
  const dict = new Map([
    ['编码', 'Encode'],
    ['解码', 'Decode'],
    ['文件处理', 'File Processing'],
    ['URL处理', 'URL Handling'],
    ['正则表达式', 'Regular Expression'],
    ['模式匹配', 'Pattern Matching'],
    ['文本处理', 'Text Processing'],
    ['语法高亮', 'Syntax Highlight'],
    ['时间戳', 'Timestamp'],
    ['Unix时间', 'Unix Time'],
    ['时区转换', 'Timezone Conversion'],
    ['批量处理', 'Batch Processing'],
    ['颜色转换', 'Color Conversion'],
    ['HEX', 'HEX'],
    ['RGB', 'RGB'],
    ['色彩格式', 'Color Format'],
    ['图片缩放', 'Image Resize'],
    ['Canvas', 'Canvas'],
    ['图像处理', 'Image Processing'],
    ['前端工具', 'Frontend Tool'],
    ['JWT', 'JWT'],
    ['令牌解码', 'Token Decode'],
    ['安全验证', 'Security Validation'],
    ['本地解析', 'Local Parsing'],
    ['JSON', 'JSON'],
    ['格式化', 'Format'],
    ['压缩', 'Compress'],
    ['数据分析', 'Data Analysis'],
    ['密码', 'Password'],
    ['安全', 'Security'],
    ['生成器', 'Generator'],
    ['强度分析', 'Strength Analysis'],
    ['隐私保护', 'Privacy Protection'],
    ['单位转换', 'Unit Conversion'],
    ['长度', 'Length'],
    ['重量', 'Weight'],
    ['温度', 'Temperature'],
    ['面积', 'Area'],
    ['体积', 'Volume'],
    ['速度', 'Speed'],
    ['时间管理', 'Time Management'],
    ['专注', 'Focus'],
    ['效率', 'Productivity'],
    ['番茄工作法', 'Pomodoro'],
    ['计时器', 'Timer'],
    ['UTM', 'UTM'],
    ['营销跟踪', 'Marketing Tracking'],
    ['链接生成', 'Link Generation'],
    ['二维码', 'QR Code'],
    ['数据导出', 'Data Export'],
    ['差异', 'Diff'],
    ['对比', 'Compare'],
    ['数据转换', 'Data Conversion'],
    ['表格数据', 'Table Data'],
    ['格式转换', 'Format Conversion'],
    ['文档处理', 'Document Processing'],
    ['文件管理', 'File Management'],
    ['制表符分隔', 'Tab Separated'],
    ['压缩', 'Compression'],
    ['解压', 'Decompression'],
    ['文件打包', 'File Archiving'],
    ['域名解析', 'DNS Resolve'],
    ['网络查询', 'Network Query'],
    ['IP地址', 'IP Address'],
    ['域名系统', 'DNS'],
    ['HTTP', 'HTTP'],
    ['API测试', 'API Testing'],
    ['网络请求', 'Network Request'],
    ['cURL', 'cURL'],
    ['调试工具', 'Debugging Tool'],
    ['IP查询', 'IP Lookup'],
    ['地理位置', 'Geolocation'],
    ['网络定位', 'Network Location'],
    ['ISP信息', 'ISP Info'],
    ['网络分析', 'Network Analysis'],
    ['签名', 'Signing'],
    ['令牌生成', 'Token Generation'],
    ['加密算法', 'Cryptography'],
    ['MAC地址', 'MAC Address'],
    ['网络设备', 'Network Device'],
    ['厂商查询', 'Vendor Lookup'],
    ['网络管理', 'Network Management'],
    ['硬件识别', 'Hardware Identification'],
    ['MIME类型', 'MIME Type'],
    ['文件类型', 'File Type'],
    ['内容类型', 'Content Type'],
    ['网络协议', 'Network Protocol'],
    ['文件识别', 'File Identification'],
    ['身份验证', 'Authentication'],
    ['安全授权', 'Authorization'],
    ['API安全', 'API Security'],
    ['URL', 'URL'],
    ['解析', 'Parse'],
    ['构建', 'Build'],
    ['查询参数', 'Query Params'],
    ['网络', 'Network'],
    ['开发工具', 'Developer Tool'],
    ['User Agent', 'User Agent'],
    ['浏览器信息', 'Browser Info'],
    ['设备检测', 'Device Detection'],
    ['实时通信', 'Realtime Communication'],
    ['消息调试', 'Message Debug'],
    ['闪卡', 'Flashcard'],
    ['学习', 'Learning'],
    ['记忆', 'Memory'],
    ['间隔重复', 'Spaced Repetition'],
    ['教育', 'Education'],
    ['音标', 'IPA'],
    ['发音', 'Pronunciation'],
    ['语言学习', 'Language Learning'],
    ['批量处理', 'Batch Processing'],
    ['拼音', 'Pinyin'],
    ['中文', 'Chinese'],
    ['语言转换', 'Language Conversion'],
    ['教育工具', 'Education Tool'],
    ['文字处理', 'Text Processing'],
    ['测验', 'Quiz'],
    ['试题', 'Questions'],
    ['评估工具', 'Assessment Tool'],
    ['文本分析', 'Text Analysis'],
    ['可读性', 'Readability'],
    ['语言质量', 'Language Quality'],
    ['写作助手', 'Writing Assistant'],
    ['音频', 'Audio'],
    ['MP3', 'MP3'],
    ['WAV', 'WAV'],
    ['多媒体处理', 'Multimedia Processing'],
    ['音频编辑', 'Audio Editing'],
    ['裁剪', 'Trim'],
    ['多媒体', 'Multimedia'],
    ['剪辑工具', 'Editing Tool'],
    ['声音处理', 'Sound Processing'],
    ['EXIF', 'EXIF'],
    ['图片元数据', 'Image Metadata'],
    ['相机信息', 'Camera Info'],
    ['照片分析', 'Photo Analysis'],
    ['元数据查看', 'Metadata View'],
    ['图片压缩', 'Image Compression'],
    ['文件优化', 'File Optimization'],
    ['图片处理', 'Image Processing'],
    ['大小优化', 'Size Optimization'],
    ['性能优化', 'Performance Optimization'],
    ['水印', 'Watermark'],
    ['图片保护', 'Image Protection'],
    ['版权保护', 'Copyright Protection'],
    ['图片编辑', 'Image Editing'],
    ['数字水印', 'Digital Watermark'],
    ['表情包', 'Meme'],
    ['趣味图片', 'Funny Image'],
    ['社交娱乐', 'Social Entertainment'],
    ['图片生成', 'Image Generation'],
    ['创意工具', 'Creative Tool'],
    ['精灵图', 'Sprite'],
    ['CSS精灵', 'CSS Sprite'],
    ['网页性能', 'Web Performance'],
    ['GIF', 'GIF'],
    ['视频转换', 'Video Conversion'],
    ['动画制作', 'Animation'],
    ['多媒体转换', 'Media Conversion'],
    ['坐标转换', 'Coordinate Conversion'],
    ['地理坐标', 'Geographic Coordinate'],
    ['GPS', 'GPS'],
    ['度分秒', 'DMS'],
    ['地理工具', 'Geo Tool'],
    ['海拔', 'Elevation'],
    ['地形分析', 'Terrain Analysis'],
    ['地理数据', 'Geospatial Data'],
    ['高程图', 'Elevation Map'],
    ['地图快照', 'Map Snapshot'],
    ['地图截图', 'Map Screenshot'],
    ['地图服务', 'Map Service'],
    ['图像生成', 'Image Generation'],
    ['大数计算', 'Big Number'],
    ['数学工具', 'Math Tool'],
    ['高精度计算', 'High Precision'],
    ['数字运算', 'Number Operation'],
    ['计算器', 'Calculator'],
    ['排列组合', 'Combinatorics'],
    ['数学计算', 'Math Calculation'],
    ['组合数学', 'Combinatorics'],
    ['概率统计', 'Probability & Statistics'],
    ['计算工具', 'Calculation Tool'],
    ['货币转换', 'Currency Conversion'],
    ['汇率', 'Exchange Rate'],
    ['金融工具', 'Finance Tool'],
    ['国际货币', 'International Currency'],
    ['财经计算', 'Financial Calculation'],
    ['方程求解', 'Equation Solving'],
    ['代数计算', 'Algebra'],
    ['解方程', 'Solve Equations'],
    ['数学求解', 'Math Solve'],
    ['分数', 'Fraction'],
    ['小数', 'Decimal'],
    ['数学转换', 'Math Conversion'],
    ['循环小数', 'Repeating Decimal'],
    ['矩阵', 'Matrix'],
    ['线性代数', 'Linear Algebra'],
    ['行列式', 'Determinant'],
    ['房贷', 'Mortgage'],
    ['贷款计算', 'Loan Calculation'],
    ['还款计划', 'Repayment Plan'],
    ['财务计算', 'Financial Calculation'],
    ['质数', 'Prime'],
    ['数字生成', 'Number Generation'],
    ['素数', 'Prime'],
    ['数据可视化', 'Data Visualization'],
    ['时间分析', 'Time Analysis'],
    ['图表生成', 'Chart Generation'],
    ['可视化工具', 'Visualization Tool'],
    ['邮件模板', 'Email Template'],
    ['邮件设计', 'Email Design'],
    ['模板构建', 'Template Builder'],
    ['邮件营销', 'Email Marketing'],
    ['办公工具', 'Productivity Tool'],
    ['习惯追踪', 'Habit Tracking'],
    ['个人成长', 'Personal Growth'],
    ['目标管理', 'Goal Management'],
    ['看板', 'Kanban'],
    ['项目管理', 'Project Management'],
    ['任务管理', 'Task Management'],
    ['敏捷开发', 'Agile'],
    ['工作流', 'Workflow'],
    ['文本编辑', 'Text Editing'],
    ['文档编写', 'Documentation'],
    ['编辑器', 'Editor'],
    ['会议记录', 'Meeting Notes'],
    ['文档格式化', 'Document Formatting'],
    ['会议管理', 'Meeting Management'],
    ['笔记整理', 'Note Organizer'],
    ['思维导图', 'Mindmap'],
    ['脑图', 'Mindmap'],
    ['思维整理', 'Mind Organization'],
    ['可视化思考', 'Visual Thinking'],
    ['简历', 'Resume'],
    ['求职工具', 'Job Hunting'],
    ['职业发展', 'Career'],
    ['模板生成', 'Template Generation'],
    ['文档创建', 'Document Creation'],
    ['表格编辑', 'Table Editing'],
    ['数据表格', 'Data Table'],
    ['数据管理', 'Data Management'],
    ['信用卡', 'Credit Card'],
    ['验证工具', 'Validator'],
    ['金融安全', 'Financial Security'],
    ['支付验证', 'Payment Validation'],
    ['差异分析', 'Difference Analysis'],
    ['版本对比', 'Version Diff'],
    ['代码审查', 'Code Review'],
    ['文档比较', 'Document Compare'],
    ['Glob模式', 'Glob Pattern'],
    ['文件匹配', 'File Matching'],
    ['路径过滤', 'Path Filter'],
    ['通配符', 'Wildcard'],
    ['构建工具', 'Build Tool'],
    ['文件系统', 'File System'],
    ['银行账户', 'Bank Account'],
    ['国际支付', 'International Payment'],
    ['金融验证', 'Financial Validation'],
    ['占位文本', 'Placeholder Text'],
    ['设计工具', 'Design Tool'],
    ['排版测试', 'Typography Test'],
    ['文本生成', 'Text Generation'],
    ['URL优化', 'URL Optimization'],
    ['SEO工具', 'SEO Tool'],
    ['链接生成', 'Link Generation'],
    ['GUID', 'GUID'],
    ['唯一标识符', 'Unique Identifier'],
    ['随机', 'Random'],
    ['验证', 'Validation'],
    ['AES', 'AES'],
    ['解密', 'Decrypt'],
    ['数据保护', 'Data Protection'],
    ['密码学', 'Cryptography'],
    ['数据校验', 'Data Check'],
    ['元数据清理', 'Metadata Cleanup'],
    ['图片隐私', 'Image Privacy'],
    ['数据安全', 'Data Security'],
    ['公钥密码', 'Public-key Crypto'],
    ['安全笔记', 'Secure Notes'],
    ['加密存储', 'Encrypted Storage'],
    ['个人信息', 'Personal Data'],
    ['2FA', '2FA'],
    ['TOTP', 'TOTP'],
    ['双重认证', 'Two-factor Auth'],
    ['身份验证', 'Authentication'],
    ['标签生成', 'Hashtag Generation'],
    ['话题标签', 'Hashtag'],
    ['内容优化', 'Content Optimization'],
    ['关键词密度', 'Keyword Density'],
    ['SEO分析', 'SEO Analysis'],
    ['搜索引擎优化', 'SEO'],
    ['Open Graph', 'Open Graph'],
    ['社交媒体图片', 'Social Image'],
    ['SEO优化', 'SEO Optimization'],
    ['内容营销', 'Content Marketing'],
    ['网站地图', 'Sitemap'],
    ['站点管理', 'Site Management'],
    ['网站分析', 'Site Analytics'],
    ['发布计划', 'Scheduling'],
    ['内容管理', 'Content Management'],
    ['时间安排', 'Time Scheduling'],
    ['浏览器工具', 'Browser Tool'],
    ['网站调试', 'Site Debugging'],
    ['文件检查', 'File Inspection'],
    ['调试工具', 'Debugging Tool'],
    ['浏览器存储', 'Browser Storage'],
    ['用户体验', 'UX'],
    ['Web API', 'Web API'],
    ['性能分析', 'Performance Analysis'],
    ['性能监控', 'Performance Monitoring'],
    ['优化工具', 'Optimization Tool'],
    ['网页性能', 'Web Performance'],
    ['离线应用', 'Offline App'],
    ['缓存管理', 'Cache Management'],
    ['网络请求', 'Network Request']
  ]);
  return tags.map((t) => dict.get(t) || t);
}

/** Convert zh-CN tags to zh-TW (Traditional) using a dictionary; fallback to original */
function convertTagsToTraditional(tags) {
  const dict = new Map([
    ['编码', '編碼'],
    ['解码', '解碼'],
    ['文件处理', '檔案處理'],
    ['URL处理', 'URL處理'],
    ['正则表达式', '正則表達式'],
    ['模式匹配', '模式比對'],
    ['文本处理', '文字處理'],
    ['语法高亮', '語法高亮'],
    ['时间戳', '時間戳'],
    ['Unix时间', 'Unix時間'],
    ['时区转换', '時區轉換'],
    ['批量处理', '批次處理'],
    ['颜色转换', '顏色轉換'],
    ['色彩格式', '色彩格式'],
    ['图片缩放', '圖片縮放'],
    ['图像处理', '影像處理'],
    ['前端工具', '前端工具'],
    ['令牌解码', '權杖解碼'],
    ['安全验证', '安全驗證'],
    ['本地解析', '本機解析'],
    ['格式化', '格式化'],
    ['压缩', '壓縮'],
    ['数据分析', '資料分析'],
    ['密码', '密碼'],
    ['强度分析', '強度分析'],
    ['隐私保护', '隱私保護'],
    ['单位转换', '單位轉換'],
    ['长度', '長度'],
    ['重量', '重量'],
    ['温度', '溫度'],
    ['面积', '面積'],
    ['体积', '體積'],
    ['速度', '速度'],
    ['时间管理', '時間管理'],
    ['专注', '專注'],
    ['效率', '效率'],
    ['番茄工作法', '番茄工作法'],
    ['计时器', '計時器'],
    ['营销跟踪', '行銷追蹤'],
    ['链接生成', '連結生成'],
    ['二维码', '二維碼'],
    ['数据导出', '資料匯出'],
    ['差异', '差異'],
    ['对比', '對比'],
    ['数据转换', '資料轉換'],
    ['表格数据', '表格資料'],
    ['格式转换', '格式轉換'],
    ['文档处理', '文件處理'],
    ['文件管理', '檔案管理'],
    ['制表符分隔', '定位字元分隔'],
    ['解压', '解壓'],
    ['文件打包', '檔案封裝'],
    ['域名解析', '網域解析'],
    ['网络查询', '網路查詢'],
    ['IP地址', 'IP位址'],
    ['域名系统', '網域名稱系統'],
    ['API测试', 'API測試'],
    ['网络请求', '網路請求'],
    ['调试工具', '除錯工具'],
    ['IP查询', 'IP查詢'],
    ['地理位置', '地理位置'],
    ['网络定位', '網路定位'],
    ['ISP信息', 'ISP資訊'],
    ['网络分析', '網路分析'],
    ['签名', '簽名'],
    ['令牌生成', '權杖生成'],
    ['加密算法', '加密演算法'],
    ['网络设备', '網路設備'],
    ['厂商查询', '廠商查詢'],
    ['网络管理', '網路管理'],
    ['硬件识别', '硬體識別'],
    ['文件类型', '檔案類型'],
    ['内容类型', '內容類型'],
    ['网络协议', '網路協定'],
    ['文件识别', '檔案辨識'],
    ['身份验证', '身分驗證'],
    ['安全授权', '安全授權'],
    ['API安全', 'API安全'],
    ['解析', '解析'],
    ['构建', '建構'],
    ['查询参数', '查詢參數'],
    ['开发工具', '開發工具'],
    ['浏览器信息', '瀏覽器資訊'],
    ['设备检测', '裝置偵測'],
    ['实时通信', '即時通訊'],
    ['消息调试', '訊息除錯'],
    ['闪卡', '閃卡'],
    ['学习', '學習'],
    ['记忆', '記憶'],
    ['间隔重复', '間隔重複'],
    ['音标', '音標'],
    ['发音', '發音'],
    ['语言学习', '語言學習'],
    ['批量处理', '批次處理'],
    ['中文', '中文'],
    ['语言转换', '語言轉換'],
    ['教育工具', '教育工具'],
    ['文字处理', '文字處理'],
    ['测验', '測驗'],
    ['试题', '試題'],
    ['评估工具', '評估工具'],
    ['文本分析', '文本分析'],
    ['可读性', '可讀性'],
    ['语言质量', '語言品質'],
    ['写作助手', '寫作助手'],
    ['音频', '音訊'],
    ['多媒体处理', '多媒體處理'],
    ['音频编辑', '音訊編輯'],
    ['裁剪', '裁切'],
    ['多媒体', '多媒體'],
    ['剪辑工具', '剪輯工具'],
    ['声音处理', '聲音處理'],
    ['图片元数据', '圖片中繼資料'],
    ['相机信息', '相機資訊'],
    ['照片分析', '照片分析'],
    ['元数据查看', '中繼資料檢視'],
    ['图片压缩', '圖片壓縮'],
    ['文件优化', '檔案優化'],
    ['图片处理', '圖片處理'],
    ['大小优化', '大小優化'],
    ['性能优化', '效能優化'],
    ['水印', '浮水印'],
    ['图片保护', '圖片保護'],
    ['版权保护', '版權保護'],
    ['图片编辑', '圖片編輯'],
    ['数字水印', '數位浮水印'],
    ['表情包', '迷因'],
    ['趣味图片', '趣味圖片'],
    ['社交娱乐', '社交娛樂'],
    ['图片生成', '圖片生成'],
    ['创意工具', '創意工具'],
    ['精灵图', '精靈圖'],
    ['CSS精灵', 'CSS精靈'],
    ['网页性能', '網頁效能'],
    ['视频转换', '影片轉換'],
    ['动画制作', '動畫製作'],
    ['多媒体转换', '多媒體轉換'],
    ['坐标转换', '座標轉換'],
    ['地理坐标', '地理座標'],
    ['度分秒', '度分秒'],
    ['地理工具', '地理工具'],
    ['海拔', '海拔'],
    ['地形分析', '地形分析'],
    ['地理数据', '地理資料'],
    ['高程图', '高程圖'],
    ['地图快照', '地圖快照'],
    ['地图截图', '地圖截圖'],
    ['地图服务', '地圖服務'],
    ['图像生成', '影像生成'],
    ['大数计算', '大數計算'],
    ['数学工具', '數學工具'],
    ['高精度计算', '高精度計算'],
    ['数字运算', '數字運算'],
    ['计算器', '計算器'],
    ['排列组合', '排列組合'],
    ['数学计算', '數學計算'],
    ['组合数学', '組合數學'],
    ['概率统计', '機率統計'],
    ['计算工具', '計算工具'],
    ['货币转换', '貨幣轉換'],
    ['汇率', '匯率'],
    ['金融工具', '金融工具'],
    ['国际货币', '國際貨幣'],
    ['财经计算', '財經計算'],
    ['方程求解', '方程求解'],
    ['代数计算', '代數計算'],
    ['解方程', '解方程'],
    ['数学求解', '數學求解'],
    ['分数', '分數'],
    ['小数', '小數'],
    ['数学转换', '數學轉換'],
    ['循环小数', '循環小數'],
    ['矩阵', '矩陣'],
    ['线性代数', '線性代數'],
    ['行列式', '行列式'],
    ['房贷', '房貸'],
    ['贷款计算', '貸款計算'],
    ['还款计划', '還款計畫'],
    ['财务计算', '財務計算'],
    ['质数', '質數'],
    ['数字生成', '數字生成'],
    ['素数', '質數'],
    ['数据可视化', '資料視覺化'],
    ['时间分析', '時間分析'],
    ['图表生成', '圖表生成'],
    ['可视化工具', '視覺化工具'],
    ['邮件模板', '郵件範本'],
    ['邮件设计', '郵件設計'],
    ['模板构建', '模板建構'],
    ['邮件营销', '郵件行銷'],
    ['办公工具', '辦公工具'],
    ['习惯追踪', '習慣追蹤'],
    ['个人成长', '個人成長'],
    ['目标管理', '目標管理'],
    ['项目管理', '專案管理'],
    ['任务管理', '任務管理'],
    ['敏捷开发', '敏捷開發'],
    ['工作流', '工作流程'],
    ['文本编辑', '文本編輯'],
    ['文档编写', '文件編寫'],
    ['编辑器', '編輯器'],
    ['会议记录', '會議紀錄'],
    ['文档格式化', '文件格式化'],
    ['会议管理', '會議管理'],
    ['笔记整理', '筆記整理'],
    ['思维导图', '心智圖'],
    ['脑图', '腦圖'],
    ['思维整理', '思維整理'],
    ['可视化思考', '視覺化思考'],
    ['简历', '履歷'],
    ['求职工具', '求職工具'],
    ['职业发展', '職涯發展'],
    ['模板生成', '模板產生'],
    ['文档创建', '文件建立'],
    ['表格编辑', '表格編輯'],
    ['数据表格', '資料表格'],
    ['数据管理', '資料管理'],
    ['信用卡', '信用卡'],
    ['验证工具', '驗證工具'],
    ['金融安全', '金融安全'],
    ['支付验证', '支付驗證'],
    ['差异分析', '差異分析'],
    ['版本对比', '版本對比'],
    ['代码审查', '程式碼審查'],
    ['文档比较', '文件比較'],
    ['文件匹配', '檔案比對'],
    ['路径过滤', '路徑過濾'],
    ['通配符', '萬用字元'],
    ['构建工具', '建置工具'],
    ['文件系统', '檔案系統'],
    ['银行账户', '銀行帳戶'],
    ['国际支付', '國際支付'],
    ['金融验证', '金融驗證'],
    ['占位文本', '占位文字'],
    ['设计工具', '設計工具'],
    ['排版测试', '排版測試'],
    ['文本生成', '文字生成'],
    ['URL优化', 'URL最佳化'],
    ['SEO工具', 'SEO工具'],
    ['链接生成', '連結生成'],
    ['唯一标识符', '唯一識別符'],
    ['随机', '隨機'],
    ['验证', '驗證'],
    ['解密', '解密'],
    ['数据保护', '資料保護'],
    ['密码学', '密碼學'],
    ['数据校验', '資料校驗'],
    ['元数据清理', '中繼資料清理'],
    ['图片隐私', '圖片隱私'],
    ['数据安全', '資料安全'],
    ['公钥密码', '公開金鑰密碼'],
    ['安全笔记', '安全筆記'],
    ['加密存储', '加密儲存'],
    ['个人信息', '個人資訊'],
    ['双重认证', '雙重認證'],
    ['标签生成', '標籤產生'],
    ['话题标签', '主題標籤'],
    ['内容优化', '內容最佳化'],
    ['关键词密度', '關鍵字密度'],
    ['SEO分析', 'SEO分析'],
    ['搜索引擎优化', '搜尋引擎優化'],
    ['社交媒体图片', '社群圖片'],
    ['SEO优化', 'SEO最佳化'],
    ['内容营销', '內容行銷'],
    ['网站地图', '網站地圖'],
    ['站点管理', '站台管理'],
    ['网站分析', '網站分析'],
    ['发布计划', '發布計畫'],
    ['内容管理', '內容管理'],
    ['时间安排', '時間安排'],
    ['浏览器工具', '瀏覽器工具'],
    ['网站调试', '網站除錯'],
    ['文件检查', '檔案檢查'],
    ['浏览器存储', '瀏覽器儲存'],
    ['用户体验', '使用者體驗'],
    ['性能分析', '效能分析'],
    ['性能监控', '效能監控'],
    ['优化工具', '最佳化工具'],
    ['网页性能', '網頁效能'],
    ['离线应用', '離線應用'],
    ['缓存管理', '快取管理']
  ]);
  return tags.map((t) => dict.get(t) || t);
}

function main() {
  const srcPath = path.join(localesDir, SRC);
  const enPath = path.join(localesDir, EN);
  const twPath = path.join(localesDir, ZH_TW);

  if (!fs.existsSync(srcPath)) {
    console.error(`[ERROR] Source ${SRC} not found at ${srcPath}`);
    process.exit(1);
  }
  if (!fs.existsSync(enPath) || !fs.existsSync(twPath)) {
    console.error('[ERROR] Target locale files not found. Make sure en.json and zh-TW.json exist.');
    process.exit(1);
  }

  const zhCN = readJSON(srcPath);
  const en = readJSON(enPath);
  const zhTW = readJSON(twPath);

  const report = {
    en: { tagsAdded: 0, toolsScanned: 0, missingNameDesc: [] },
    zhTW: { tagsAdded: 0, toolsScanned: 0, missingNameDesc: [] }
  };

  const toolsCN = zhCN.tools || {};
  const toolsEN = en.tools || (en.tools = {});
  const toolsTW = zhTW.tools || (zhTW.tools = {});

  // Traverse tools in zh-CN as source of truth
  for (const key of Object.keys(toolsCN)) {
    const srcTool = toolsCN[key];
    const srcTags = ensureArray(srcTool.tags);

    // EN
    {
      report.en.toolsScanned++;
      const tgt = toolsEN[key] || (toolsEN[key] = {});
      // Ensure tags field exists
      if (!Array.isArray(tgt.tags)) {
        tgt.tags = [];
      }
      // If empty, adopt from zh-CN first to keep parity
      if (tgt.tags.length === 0 && srcTags.length > 0) {
        tgt.tags = [...srcTags];
        report.en.tagsAdded++;
      }
      // Semantic localization: translate to English
      if (tgt.tags.length > 0) {
        tgt.tags = translateTagsToEnglish(tgt.tags);
      }
      // Track missing name/desc (do not auto-overwrite)
      if (tgt.name == null || tgt.desc == null) {
        report.en.missingNameDesc.push(key);
      }
    }

    // ZH-TW
    {
      report.zhTW.toolsScanned++;
      const tgt = toolsTW[key] || (toolsTW[key] = {});
      if (!Array.isArray(tgt.tags)) {
        tgt.tags = [];
      }
      if (tgt.tags.length === 0 && srcTags.length > 0) {
        tgt.tags = [...srcTags];
        report.zhTW.tagsAdded++;
      }
      // Semantic localization: convert to Traditional Chinese
      if (tgt.tags.length > 0) {
        tgt.tags = convertTagsToTraditional(tgt.tags);
      }
      if (tgt.name == null || tgt.desc == null) {
        report.zhTW.missingNameDesc.push(key);
      }
    }
  }

  // Write back
  writeJSON(enPath, en);
  writeJSON(twPath, zhTW);

  // Summary
  console.log('i18n tags sync complete.');
  console.log(`EN: scanned ${report.en.toolsScanned}, tags added ${report.en.tagsAdded}`);
  console.log(`ZH-TW: scanned ${report.zhTW.toolsScanned}, tags added ${report.zhTW.tagsAdded}`);

  // Only show top few missing to keep console clean
  const showTop = 10;
  if (report.en.missingNameDesc.length) {
    console.log(`EN missing name/desc (${report.en.missingNameDesc.length}):`, report.en.missingNameDesc.slice(0, showTop));
  }
  if (report.zhTW.missingNameDesc.length) {
    console.log(`ZH-TW missing name/desc (${report.zhTW.missingNameDesc.length}):`, report.zhTW.missingNameDesc.slice(0, showTop));
  }

  console.log('\nNote: tags were copied from zh-CN to ensure field completeness.');
  console.log('If you need English tags or Traditional Chinese tags, extend this script to translate tags based on a dictionary or integrate OpenCC for zh-TW.');
}

main();
